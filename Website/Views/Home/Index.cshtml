@using RazorClientTemplates
@model IEnumerable<Website.Models.Movie>
@{
    ViewBag.Title = "My Movies";
}

<h2>@ViewBag.Title</h2>
<section id="movies">
    
    @foreach(var movie in Model)
    {
        @Html.Partial("Movie", movie)
    }

</section>

<div>
    <button id="load-more">Load More...</button>
</div>


<script type="text/javascript">

    var movieClientTemplate = @Html.ClientTemplate("Movie");

    $(function() {
        $('#load-more').click(function() {
            $.ajax({
                url: '@Url.Action("MoreMovies", "Home")',
                success: function (movies) {
                    var moviesContainer = $('#movies');
                    $.each(movies, function (idx, movie) {
                        var renderedTemplate = movieClientTemplate(movie);
                        moviesContainer.append(renderedTemplate);
                    });
                }
            });
        });
    });

</script>